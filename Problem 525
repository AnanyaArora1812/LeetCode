class Solution(object):
    def findMaxLength(self, nums):

        
        prefix_index = {0: -1}  
        max_len = 0 
        cum_sum = 0

        for i, num in enumerate(nums):
          
            if num == 0:
                cum_sum -= 1
            else:
                cum_sum += 1

           
            if cum_sum in prefix_index:
                max_len = max(max_len, i - prefix_index[cum_sum])
            else:
                prefix_index[cum_sum] = i

        return max_len
